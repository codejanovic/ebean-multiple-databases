# ebean-multiple-databases
# Database Setup
This example contains a total of 4 databases, having 3 readonly database for query only and a main database for the Application: 
- 'main' Main Application database 
  - goal: managed by ebean with migration
- 'ro1' Readonly database for query
  - goal: ebean query only, no migration
- 'ro2' Readonly database for query
  - goal: ebean query only, no migration
- 'ro3' Readonly database for query
  - goal: ebean query only, no migration

Although the readonly databases contain sample tables & data, for the sake of this example the every Ebean-Entity is referencing a non-existing table. 
- DbMainCity is referencing "main_city"
- DbRo1City is referencing "ro1_city"
- DbRo2City is referencing "ro1_city"
- DbRo3City is referencing "ro1_city"

# Generating Migration
Running `GenerateDbMigration.java` will generate the following `1.0__initial.sql` for me:

Actual:
```postgresql
-- apply changes
-- apply changes
create table main_city (
   city_population               bigint not null,
   version                       bigint not null,
   created_at                    timestamptz not null,
   updated_at                    timestamptz not null,
   city_name                     varchar(255),
   city_country_code             varchar(255),
   city_district                 varchar(255),
   city_local_name               varchar(255)
);

create table ro1_city (
    id                            bigint generated by default as identity not null,
    population                    bigint not null,
    name                          varchar(255),
    country_code                  varchar(255),
    district                      varchar(255),
    local_name                    varchar(255),
    constraint pk_ro1_city primary key (id)
);

create table ro2_city (
    id                            bigint generated by default as identity not null,
    population                    bigint not null,
    name                          varchar(255),
    country_code                  varchar(255),
    district                      varchar(255),
    local_name                    varchar(255),
    constraint pk_ro2_city primary key (id)
);

create table ro3_city (
    id                            bigint generated by default as identity not null,
    population                    bigint not null,
    name                          varchar(255),
    country_code                  varchar(255),
    district                      varchar(255),
    local_name                    varchar(255),
    constraint pk_ro3_city primary key (id)
);


```

Expected:
```postgresql
-- apply changes
create table main_city (
  city_population               bigint not null,
  version                       bigint not null,
  created_at                    timestamptz not null,
  updated_at                    timestamptz not null,
  city_name                     varchar(255),
  city_country_code             varchar(255),
  city_district                 varchar(255),
  city_local_name               varchar(255)
);
```

# Running Application
Starting the application will then migrate all Databases instead of only the main one:

```
SLF4J: Class path contains multiple SLF4J providers.
SLF4J: Found provider [org.apache.logging.slf4j.SLF4JServiceProvider@5ed828d]
SLF4J: Found provider [org.slf4j.simple.SimpleServiceProvider@50d0686]
SLF4J: See https://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual provider is of type [org.apache.logging.slf4j.SLF4JServiceProvider@5ed828d]
2025-01-07 23:07:14.078 [main] INFO  i.ebean  - ebean version: 15.8.1
2025-01-07 23:07:14.089 [main] INFO  i.a.config  - Loaded properties from [resource:application.properties] 
2025-01-07 23:07:14.257 [main] INFO  i.e.datasource  - DataSource [db] autoCommit[false] [READ_COMMITTED] min[2] max[200] in[138ms]
2025-01-07 23:07:14.377 [main] INFO  i.e.migration  - DB migrations completed in 13ms - totalMigrations:1 readResources:3ms
2025-01-07 23:07:14.378 [main] INFO  i.e.core  - Started database[db] platform[POSTGRES] in 269ms
2025-01-07 23:07:14.400 [main] INFO  i.g.c.e.e.Application  - 0
2025-01-07 23:07:14.430 [main] INFO  i.e.datasource  - DataSource [ro1] autoCommit[false] [READ_COMMITTED] min[2] max[200] in[26ms]
2025-01-07 23:07:14.448 [main] INFO  i.e.DDL  - Executing create migration table - 1 statements, autoCommit:false
2025-01-07 23:07:14.459 [main] INFO  i.e.DDL  - Executing run migration version: 1.0__initial - 4 statements, autoCommit:false
2025-01-07 23:07:14.466 [main] INFO  i.e.migration  - DB migrations completed in 33ms - executed:1 totalMigrations:1 mode:legacy
2025-01-07 23:07:14.466 [main] INFO  i.e.core  - Started database[ro1] platform[POSTGRES] in 62ms
2025-01-07 23:07:14.468 [main] INFO  i.g.c.e.e.Application  - 0
2025-01-07 23:07:14.489 [main] INFO  i.e.datasource  - DataSource [ro2] autoCommit[false] [READ_COMMITTED] min[2] max[200] in[16ms]
2025-01-07 23:07:14.498 [main] INFO  i.e.DDL  - Executing create migration table - 1 statements, autoCommit:false
2025-01-07 23:07:14.506 [main] INFO  i.e.DDL  - Executing run migration version: 1.0__initial - 4 statements, autoCommit:false
2025-01-07 23:07:14.519 [main] INFO  i.e.migration  - DB migrations completed in 28ms - executed:1 totalMigrations:1 mode:legacy
2025-01-07 23:07:14.519 [main] INFO  i.e.core  - Started database[ro2] platform[POSTGRES] in 47ms
2025-01-07 23:07:14.522 [main] INFO  i.g.c.e.e.Application  - 0
2025-01-07 23:07:14.541 [main] INFO  i.e.datasource  - DataSource [ro3] autoCommit[false] [READ_COMMITTED] min[2] max[200] in[16ms]
2025-01-07 23:07:14.550 [main] INFO  i.e.DDL  - Executing create migration table - 1 statements, autoCommit:false
2025-01-07 23:07:14.557 [main] INFO  i.e.DDL  - Executing run migration version: 1.0__initial - 4 statements, autoCommit:false
2025-01-07 23:07:14.564 [main] INFO  i.e.migration  - DB migrations completed in 21ms - executed:1 totalMigrations:1 mode:legacy
2025-01-07 23:07:14.564 [main] INFO  i.e.core  - Started database[ro3] platform[POSTGRES] in 39ms
2025-01-07 23:07:14.566 [main] INFO  i.g.c.e.e.Application  - 0
2025-01-07 23:07:14.566 [main] INFO  i.g.c.e.e.Application  - Application started!
```